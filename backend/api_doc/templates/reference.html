{% extends "base.html" %}

{% block title %}API Reference - Jazz Reference API Documentation{% endblock %}

{% block content %}
<h1>API Reference</h1>
<p>Complete reference for all available endpoints in the Jazz Reference API.</p>

<!-- SONGS ENDPOINTS -->
<section class="endpoint-section">
    <h2 id="songs">Songs</h2>
    
    <!-- GET /api/songs -->
    <div class="endpoint-card">
        <div class="endpoint-header">
            <div class="endpoint-title">
                <span class="method get">GET</span>
                <span class="endpoint-path">/api/songs</span>
            </div>
            <p class="endpoint-description">Get all songs or search songs by title or composer</p>
        </div>
        <div class="endpoint-body">
            <h4>Query Parameters</h4>
            <table class="params-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Type</th>
                        <th>Required</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>search</code></td>
                        <td>string</td>
                        <td>No</td>
                        <td>Search query to filter songs by title or composer (case-insensitive)</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response (200 OK)</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">JSON</span>
                </div>
                <pre><code>[
  {
    "id": 1,
    "title": "Take Five",
    "composer": "Paul Desmond",
    "structure": "AABA in Eb minor",
    "musicbrainz_id": "abc123",
    "song_reference": "Dave Brubeck Quartet recording",
    "external_references": {
      "wikipedia": "https://en.wikipedia.org/wiki/Take_Five"
    },
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T10:30:00Z"
  }
]</code></pre>
            </div>

            <h4>Example Requests</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">cURL</span>
                </div>
                <pre><code># Get all songs
curl {{ base_url }}/api/songs

# Search for songs
curl "{{ base_url }}/api/songs?search=blue"</code></pre>
            </div>
        </div>
    </div>

    <!-- GET /api/songs/<id> -->
    <div class="endpoint-card">
        <div class="endpoint-header">
            <div class="endpoint-title">
                <span class="method get">GET</span>
                <span class="endpoint-path">/api/songs/&lt;song_id&gt;</span>
            </div>
            <p class="endpoint-description">Get detailed information about a specific song</p>
        </div>
        <div class="endpoint-body">
            <h4>Path Parameters</h4>
            <table class="params-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>song_id</code></td>
                        <td>integer</td>
                        <td>The unique identifier of the song</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response (200 OK)</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">JSON</span>
                </div>
                <pre><code>{
  "id": 1,
  "title": "Take Five",
  "composer": "Paul Desmond",
  "structure": "AABA in Eb minor",
  "musicbrainz_id": "abc123",
  "song_reference": "Dave Brubeck Quartet recording",
  "external_references": {
    "wikipedia": "https://en.wikipedia.org/wiki/Take_Five"
  },
  "created_at": "2024-01-15T10:30:00Z",
  "updated_at": "2024-01-15T10:30:00Z"
}</code></pre>
            </div>

            <h4>Example Request</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">cURL</span>
                </div>
                <pre><code>curl {{ base_url }}/api/songs/1</code></pre>
            </div>

            <h4>Error Response (404 Not Found)</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">JSON</span>
                </div>
                <pre><code>{
  "error": "Song not found"
}</code></pre>
            </div>
        </div>
    </div>

    <!-- GET /api/songs/<id>/recordings -->
    <div class="endpoint-card">
        <div class="endpoint-header">
            <div class="endpoint-title">
                <span class="method get">GET</span>
                <span class="endpoint-path">/api/songs/&lt;song_id&gt;/recordings</span>
            </div>
            <p class="endpoint-description">Get all recordings of a specific song</p>
        </div>
        <div class="endpoint-body">
            <h4>Path Parameters</h4>
            <table class="params-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>song_id</code></td>
                        <td>integer</td>
                        <td>The unique identifier of the song</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response (200 OK)</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">JSON</span>
                </div>
                <pre><code>[
  {
    "id": 1,
    "song_id": 1,
    "album_title": "Time Out",
    "recording_date": "1959-07-01",
    "label": "Columbia Records",
    "musicbrainz_id": "xyz789",
    "spotify_url": "spotify:track:...",
    "youtube_url": "https://youtube.com/watch?v=...",
    "is_canonical": true,
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T10:30:00Z"
  }
]</code></pre>
            </div>

            <h4>Example Request</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">cURL</span>
                </div>
                <pre><code>curl {{ base_url }}/api/songs/1/recordings</code></pre>
            </div>
        </div>
    </div>
</section>

<!-- RECORDINGS ENDPOINTS -->
<section class="endpoint-section">
    <h2 id="recordings">Recordings</h2>
    
    <!-- GET /api/recordings -->
    <div class="endpoint-card">
        <div class="endpoint-header">
            <div class="endpoint-title">
                <span class="method get">GET</span>
                <span class="endpoint-path">/api/recordings</span>
            </div>
            <p class="endpoint-description">Get all recordings or search by album title</p>
        </div>
        <div class="endpoint-body">
            <h4>Query Parameters</h4>
            <table class="params-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Type</th>
                        <th>Required</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>search</code></td>
                        <td>string</td>
                        <td>No</td>
                        <td>Search query to filter recordings by album title</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response (200 OK)</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">JSON</span>
                </div>
                <pre><code>[
  {
    "id": 1,
    "song_id": 1,
    "album_title": "Time Out",
    "recording_date": "1959-07-01",
    "label": "Columbia Records",
    "musicbrainz_id": "xyz789",
    "spotify_url": "spotify:track:...",
    "youtube_url": "https://youtube.com/watch?v=...",
    "is_canonical": true,
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T10:30:00Z"
  }
]</code></pre>
            </div>

            <h4>Example Request</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">cURL</span>
                </div>
                <pre><code>curl "{{ base_url }}/api/recordings?search=time%20out"</code></pre>
            </div>
        </div>
    </div>

    <!-- GET /api/recordings/<id> -->
    <div class="endpoint-card">
        <div class="endpoint-header">
            <div class="endpoint-title">
                <span class="method get">GET</span>
                <span class="endpoint-path">/api/recordings/&lt;recording_id&gt;</span>
            </div>
            <p class="endpoint-description">Get detailed information about a specific recording with full performer lineup</p>
        </div>
        <div class="endpoint-body">
            <h4>Path Parameters</h4>
            <table class="params-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>recording_id</code></td>
                        <td>integer</td>
                        <td>The unique identifier of the recording</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response (200 OK)</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">JSON</span>
                </div>
                <pre><code>{
  "recording": {
    "id": 1,
    "song_id": 1,
    "song_title": "Take Five",
    "album_title": "Time Out",
    "recording_date": "1959-07-01",
    "label": "Columbia Records",
    "spotify_url": "spotify:track:...",
    "youtube_url": "https://youtube.com/watch?v=...",
    "is_canonical": true
  },
  "performers": [
    {
      "performer_id": 1,
      "name": "Dave Brubeck",
      "instrument": "Piano"
    },
    {
      "performer_id": 2,
      "name": "Paul Desmond",
      "instrument": "Alto Saxophone"
    }
  ]
}</code></pre>
            </div>

            <h4>Example Request</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">cURL</span>
                </div>
                <pre><code>curl {{ base_url }}/api/recordings/1</code></pre>
            </div>
        </div>
    </div>
</section>

<!-- PERFORMERS ENDPOINTS -->
<section class="endpoint-section">
    <h2 id="performers">Performers</h2>
    
    <!-- GET /api/performers -->
    <div class="endpoint-card">
        <div class="endpoint-header">
            <div class="endpoint-title">
                <span class="method get">GET</span>
                <span class="endpoint-path">/api/performers</span>
            </div>
            <p class="endpoint-description">Get all performers or search by name</p>
        </div>
        <div class="endpoint-body">
            <h4>Query Parameters</h4>
            <table class="params-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Type</th>
                        <th>Required</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>search</code></td>
                        <td>string</td>
                        <td>No</td>
                        <td>Search query to filter performers by name</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response (200 OK)</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">JSON</span>
                </div>
                <pre><code>[
  {
    "id": 1,
    "name": "Miles Davis",
    "biography": "Miles Dewey Davis III was an American jazz...",
    "birth_date": "1926-05-26",
    "death_date": "1991-09-28",
    "external_links": {
      "wikipedia": "https://en.wikipedia.org/wiki/Miles_Davis"
    }
  }
]</code></pre>
            </div>

            <h4>Example Request</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">cURL</span>
                </div>
                <pre><code>curl "{{ base_url }}/api/performers?search=miles"</code></pre>
            </div>
        </div>
    </div>

    <!-- GET /api/performers/<id> -->
    <div class="endpoint-card">
        <div class="endpoint-header">
            <div class="endpoint-title">
                <span class="method get">GET</span>
                <span class="endpoint-path">/api/performers/&lt;performer_id&gt;</span>
            </div>
            <p class="endpoint-description">Get detailed information about a specific performer with their complete discography</p>
        </div>
        <div class="endpoint-body">
            <h4>Path Parameters</h4>
            <table class="params-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>performer_id</code></td>
                        <td>integer</td>
                        <td>The unique identifier of the performer</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response (200 OK)</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">JSON</span>
                </div>
                <pre><code>{
  "performer": {
    "id": 1,
    "name": "Miles Davis",
    "biography": "Miles Dewey Davis III was an American jazz...",
    "birth_date": "1926-05-26",
    "death_date": "1991-09-28",
    "external_links": {
      "wikipedia": "https://en.wikipedia.org/wiki/Miles_Davis"
    }
  },
  "recordings": [
    {
      "recording_id": 5,
      "song_title": "So What",
      "album_title": "Kind of Blue",
      "recording_date": "1959-03-02",
      "instrument": "Trumpet"
    }
  ]
}</code></pre>
            </div>

            <h4>Example Request</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">cURL</span>
                </div>
                <pre><code>curl {{ base_url }}/api/performers/1</code></pre>
            </div>
        </div>
    </div>

    <!-- GET /api/performers/<id>/images -->
    <div class="endpoint-card">
        <div class="endpoint-header">
            <div class="endpoint-title">
                <span class="method get">GET</span>
                <span class="endpoint-path">/api/performers/&lt;performer_id&gt;/images</span>
            </div>
            <p class="endpoint-description">Get all images for a specific performer</p>
        </div>
        <div class="endpoint-body">
            <h4>Path Parameters</h4>
            <table class="params-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>performer_id</code></td>
                        <td>integer</td>
                        <td>The unique identifier of the performer</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response (200 OK)</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">JSON</span>
                </div>
                <pre><code>[
  {
    "id": 1,
    "url": "https://example.com/image.jpg",
    "source": "Wikimedia Commons",
    "source_identifier": "File:Miles_Davis.jpg",
    "license_type": "CC BY-SA 3.0",
    "license_url": "https://creativecommons.org/licenses/by-sa/3.0/",
    "attribution": "Photo by Tom Marcello",
    "width": 1024,
    "height": 768,
    "thumbnail_url": "https://example.com/image_thumb.jpg",
    "source_page_url": "https://commons.wikimedia.org/wiki/File:Miles_Davis.jpg",
    "is_primary": true,
    "display_order": 1
  }
]</code></pre>
            </div>

            <h4>Example Request</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">cURL</span>
                </div>
                <pre><code>curl {{ base_url }}/api/performers/1/images</code></pre>
            </div>
        </div>
    </div>
</section>

<!-- IMAGES ENDPOINTS -->
<section class="endpoint-section">
    <h2 id="images">Images</h2>
    
    <!-- GET /api/images/<id> -->
    <div class="endpoint-card">
        <div class="endpoint-header">
            <div class="endpoint-title">
                <span class="method get">GET</span>
                <span class="endpoint-path">/api/images/&lt;image_id&gt;</span>
            </div>
            <p class="endpoint-description">Get detailed information about a specific image</p>
        </div>
        <div class="endpoint-body">
            <h4>Path Parameters</h4>
            <table class="params-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>image_id</code></td>
                        <td>integer</td>
                        <td>The unique identifier of the image</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response (200 OK)</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">JSON</span>
                </div>
                <pre><code>{
  "id": 1,
  "url": "https://example.com/image.jpg",
  "source": "Wikimedia Commons",
  "source_identifier": "File:Miles_Davis.jpg",
  "license_type": "CC BY-SA 3.0",
  "license_url": "https://creativecommons.org/licenses/by-sa/3.0/",
  "attribution": "Photo by Tom Marcello",
  "width": 1024,
  "height": 768,
  "thumbnail_url": "https://example.com/image_thumb.jpg",
  "source_page_url": "https://commons.wikimedia.org/wiki/File:Miles_Davis.jpg",
  "created_at": "2024-01-15T10:30:00Z",
  "updated_at": "2024-01-15T10:30:00Z"
}</code></pre>
            </div>

            <h4>Example Request</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">cURL</span>
                </div>
                <pre><code>curl {{ base_url }}/api/images/1</code></pre>
            </div>
        </div>
    </div>
</section>

<!-- HEALTH ENDPOINT -->
<section class="endpoint-section">
    <h2 id="health">Health Check</h2>
    
    <!-- GET /api/health -->
    <div class="endpoint-card">
        <div class="endpoint-header">
            <div class="endpoint-title">
                <span class="method get">GET</span>
                <span class="endpoint-path">/api/health</span>
            </div>
            <p class="endpoint-description">Check the health status of the API and database connection</p>
        </div>
        <div class="endpoint-body">
            <h4>Response (200 OK)</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">JSON</span>
                </div>
                <pre><code>{
  "status": "healthy",
  "database": "connected",
  "pool_stats": {
    "pool_size": 5,
    "pool_available": 4,
    "requests_waiting": 0
  },
  "timestamp": 1705320600.123,
  "db_version": "PostgreSQL 15.1",
  "db_time": "2024-01-15 10:30:00"
}</code></pre>
            </div>

            <h4>Response (503 Service Unavailable)</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">JSON</span>
                </div>
                <pre><code>{
  "status": "unhealthy",
  "database": "error: connection timeout",
  "timestamp": 1705320600.123
}</code></pre>
            </div>

            <h4>Example Request</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">cURL</span>
                </div>
                <pre><code>curl {{ base_url }}/api/health</code></pre>
            </div>
        </div>
    </div>
</section>

{% endblock %}
